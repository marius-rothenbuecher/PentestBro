<Window x:Class="PentestBro.Gui.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:gui="clr-namespace:PentestBro.Gui"
        xmlns:scm="clr-namespace:System.ComponentModel;assembly=WindowsBase"
        d:DataContext="{d:DesignInstance gui:MainWindowViewModel}"
        mc:Ignorable="d" Width="1920" Height="1080"
        Title="Pentest Bro" WindowState="Maximized">

    <Window.Resources>
        <gui:BasicScanItemsWithBannerConverter x:Key="BasicScanItemsWithBanner"/>
        <gui:BoolToVisibilityConverter x:Key="BoolToVisisbility"/>
        <gui:InvertBoolConverter x:Key="InvertBool"/>
        <gui:IpPortConverter x:Key="IpPort"/>
        <gui:HttpUrlConverter x:Key="HttpUrlConverter"/>
        <gui:ZeroToBoolConverter x:Key="ZeroToBool"/>
        <gui:ZeroToVisibilityConverter x:Key="ZeroToVisibility"/>
    </Window.Resources>

    <DockPanel Margin="0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
        <DockPanel DockPanel.Dock="Top">
            <DockPanel.Resources>
                <CollectionViewSource Source="{Binding Path=TargetDisplays}" x:Key="TargetDisplays">
                    <CollectionViewSource.SortDescriptions>
                        <scm:SortDescription PropertyName="Name"/>
                    </CollectionViewSource.SortDescriptions>
                </CollectionViewSource>
            </DockPanel.Resources>

            <ComboBox Height="24" VerticalAlignment="Top" DockPanel.Dock="Left" Width="250" Margin="6 5 2 5"
                      ItemsSource="{Binding Source={StaticResource TargetDisplays}}" SelectedItem="{Binding Path=SelectedTargetDisplay}">
                <ComboBox.ItemTemplate>
                    <DataTemplate>
                        <TextBlock Text="{Binding Path=Name}"/>
                    </DataTemplate>
                </ComboBox.ItemTemplate>
            </ComboBox>
            <Button Height="24" Margin="0" Content="x" FontWeight="SemiBold"
                    Command="{Binding Path=DeleteTargetCommand}"
                    CommandParameter="{Binding Path=.}"/>
            <Button Height="24" VerticalAlignment="Top" Command="{Binding Path=AddTargetCommand}" Padding="12 2 13 3" Margin="2 5 3 5">
                <DockPanel Height="22">
                    <Image Margin="0 2 5 0" Width="14" Height="14" RenderOptions.BitmapScalingMode="Fant"
                           Source="Images/add.png"/>
                    <TextBlock FontWeight="Bold" FontSize="12" VerticalAlignment="Bottom" Text="Target"/>
                </DockPanel>
            </Button>
            <Button Height="24" VerticalAlignment="Top" Command="{Binding Path=ExportCommand}" Padding="12 2 12 3" Margin="25 5 3 5">
                <DockPanel Height="22">
                    <Image Margin="0 0 5 0" Width="25" Height="25" RenderOptions.BitmapScalingMode="Fant"
                           Source="Images/export.png"/>
                    <TextBlock FontWeight="Bold" FontSize="12" VerticalAlignment="Bottom" Text="Export"/>
                </DockPanel>
            </Button>
            <Button Height="24" VerticalAlignment="Top" Command="{Binding Path=ImportCommand}" Padding="12 2 12 3" Margin="2 5 3 5">
                <DockPanel Height="22">
                    <Image Margin="0 0 5 0" Width="25" Height="25" RenderOptions.BitmapScalingMode="Fant"
                           Source="Images/import.png"/>
                    <TextBlock FontWeight="Bold" FontSize="12" VerticalAlignment="Bottom" Text="Import"/>
                </DockPanel>
            </Button>
            <TextBlock FontSize="24" VerticalAlignment="Bottom" Margin="0 5 10 0" FontWeight="Bold" Text="Pentest Bro" DockPanel.Dock="Right"/>
            <Image DockPanel.Dock="Right" Width="40" HorizontalAlignment="Right" VerticalAlignment="Top" RenderOptions.BitmapScalingMode="Fant"
                   Source="Images/scan.png"/>
        </DockPanel>

        <TabControl Padding="0" DockPanel.Dock="Top">
            <TabControl.Style>
                <Style TargetType="{x:Type TabControl}">
                    <Setter Property="IsEnabled" Value="True"/>
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding Path=TargetDisplays.Count}" Value="0">
                            <Setter Property="IsEnabled" Value="False"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </TabControl.Style>
            <TabItem>
                <TabItem.Header>
                    <StackPanel Width="80">
                        <TextBlock HorizontalAlignment="Center" FontSize="14" FontWeight="SemiBold" Text="Overview"/>
                    </StackPanel>
                </TabItem.Header>
                <DockPanel>
                    <Border BorderBrush="#aaa" BorderThickness="0 0 1 0">
                        <DockPanel DockPanel.Dock="Left" Width="150" Background="#f7f7f7">
                            <Button Margin="15 15 15 0" DockPanel.Dock="Top" VerticalAlignment="Top" Height="24" Command="{Binding Path=AddDomainCommand}"
                                    Padding="10 3 10 3">
                                <DockPanel Height="22">
                                    <Image Margin="0 2 5 0" Width="16" Height="16"
                                   RenderOptions.BitmapScalingMode="Fant" Source="Images/add.png"/>
                                    <TextBlock FontWeight="Bold" FontSize="12" VerticalAlignment="Bottom"
                                       Text="Domain"/>
                                </DockPanel>
                            </Button>
                            <Button Margin="15 5 15 0" DockPanel.Dock="Top" VerticalAlignment="Top" Command="{Binding Path=AddIpAddressCommand}" Height="20">
                                <DockPanel Height="22">
                                    <Image Margin="0 2 5 0" Width="16" Height="16"
                                           RenderOptions.BitmapScalingMode="Fant" Source="Images/add.png"/>
                                    <TextBlock FontWeight="Bold" FontSize="12" VerticalAlignment="Bottom"
                                               Text="IP address"/>
                                </DockPanel>
                            </Button>
                            <Button Margin="15 5 15 0" DockPanel.Dock="Top" VerticalAlignment="Top" Command="{Binding Path=ScanArpCommand}" Height="20">
                                <DockPanel Height="22">
                                    <Image Margin="0 2 4 0" Width="20" Height="20" RenderOptions.BitmapScalingMode="Fant"
                                           Source="Images/search.png"/>
                                    <TextBlock FontWeight="Bold" FontSize="12" VerticalAlignment="Bottom" Text="IPs by ARP"/>
                                </DockPanel>
                            </Button>
                            <Button Margin="15 5 15 0" DockPanel.Dock="Top" VerticalAlignment="Top" Command="{Binding Path=ScanAllPortsCommand}" Height="20">
                                <DockPanel Height="22">
                                    <Image Margin="0 2 4 0" Width="20" Height="20" RenderOptions.BitmapScalingMode="Fant"
                                           Source="Images/search.png"/>
                                    <TextBlock FontWeight="Bold" FontSize="12" VerticalAlignment="Bottom" Text="All ports"/>
                                </DockPanel>
                            </Button>
                            <Button Margin="15 5 15 0" DockPanel.Dock="Top" VerticalAlignment="Top" Command="{Binding Path=ScanAllBannersCommand}" Height="20">
                                <DockPanel Height="22">
                                    <Image Margin="0 2 4 0" Width="20" Height="20" RenderOptions.BitmapScalingMode="Fant"
                                           Source="Images/search.png"/>
                                    <TextBlock FontWeight="Bold" FontSize="12" VerticalAlignment="Bottom" Text="All banners"/>
                                </DockPanel>
                            </Button>
                        </DockPanel>
                    </Border>

                    <TextBlock DockPanel.Dock="Bottom" Height="600" FontSize="30" FontWeight="SemiBold"
                               Foreground="#AAA" Padding="0 0 85 0" VerticalAlignment="Center" HorizontalAlignment="Center" Text="Please create a target first">
                        <TextBlock.Style>
                            <Style TargetType="{x:Type TextBlock}">
                                <Setter Property="Visibility" Value="Collapsed"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding Path=TargetDisplays.Count}" Value="0">
                                        <Setter Property="Visibility" Value="Visible"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>

                    <DockPanel DockPanel.Dock="Left">
                        <ScrollViewer Padding="20" Margin="5 3 3 3">
                            <ScrollViewer.Resources>
                                <CollectionViewSource Source="{Binding Path=SelectedTargetDisplay.BasicScanItemDisplays}" x:Key="BasicScanItemDisplays">
                                    <CollectionViewSource.SortDescriptions>
                                        <scm:SortDescription PropertyName="IPAddress"/>
                                    </CollectionViewSource.SortDescriptions>
                                </CollectionViewSource>
                            </ScrollViewer.Resources>

                            <ItemsControl DockPanel.Dock="Top" ItemsSource="{Binding Source={StaticResource BasicScanItemDisplays}}">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <StackPanel HorizontalAlignment="Stretch"/>
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>

                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Grid>
                                            <Grid.Resources>
                                                <CollectionViewSource Source="{Binding Path=DomainDisplays}" x:Key="DomainDisplays">
                                                    <CollectionViewSource.SortDescriptions>
                                                        <scm:SortDescription PropertyName="Host"/>
                                                    </CollectionViewSource.SortDescriptions>
                                                </CollectionViewSource>
                                            </Grid.Resources>

                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="720"/>
                                                <ColumnDefinition/>
                                                <ColumnDefinition/>
                                            </Grid.ColumnDefinitions>

                                            <Grid.RowDefinitions>
                                                <RowDefinition/>
                                                <RowDefinition/>
                                            </Grid.RowDefinitions>

                                            <DockPanel Grid.Row="0">
                                                <Button Padding="0" DockPanel.Dock="Right" Content="x" FontWeight="SemiBold"
                                                        Command="{Binding Path=DataContext.DeleteBasicScanItemCommand,
                                                                    RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Window}}"
                                                        CommandParameter="{Binding Path=.}"/>
                                                <TextBox FontSize="15" HorizontalContentAlignment="Center" 
                                                         VerticalContentAlignment="Center" Height="30"
                                                     VerticalAlignment="Top" IsReadOnly="true" Grid.Column="0" Text="{Binding Path=IPAddress, Mode=OneWay}">
                                                    <TextBox.Style>
                                                        <Style TargetType="{x:Type TextBox}">
                                                            <Setter Property="Background" Value="#EEE"/>
                                                        </Style>
                                                    </TextBox.Style>
                                                </TextBox>
                                            </DockPanel>

                                            <Grid Grid.Column="1" Grid.ColumnSpan="2" Margin="15 0 0 0">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>

                                                <Button Grid.Column="0" HorizontalAlignment="Left" Command="{Binding Path=DataContext.ScanPortsCommand,
                                                                                          RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Window}}"
                                                        CommandParameter="{Binding Path=.}" Height="20"
                                                        VerticalAlignment="Top" Margin="5 0 0 0">
                                                    <DockPanel Height="22">
                                                        <Image Margin="0 2 4 0" Width="20" Height="20" RenderOptions.BitmapScalingMode="Fant"
                                                               Source="Images/search.png"/>
                                                        <TextBlock FontWeight="Bold" FontSize="12" VerticalAlignment="Bottom" Text="Ports"/>
                                                        <Control Margin="4 2 0 0" Style="{StaticResource BusyAnimationStyle}"
                                                                 Visibility="{Binding Path=IsPortScanRunning,
                                                                                        Converter={StaticResource BoolToVisisbility}}">
                                                            <Control.LayoutTransform>
                                                                <ScaleTransform ScaleX="0.55" ScaleY="0.55"/>
                                                            </Control.LayoutTransform>
                                                        </Control>
                                                    </DockPanel>
                                                </Button>

                                                <Button IsEnabled="{Binding Path=PortDescriptions.Count, Converter={StaticResource ZeroToBool}}" Grid.Column="1" HorizontalAlignment="Left" Command="{Binding Path=DataContext.ScanBannersCommand,
                                                                                          RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Window}}"
                                                        CommandParameter="{Binding Path=.}" Height="20"
                                                        VerticalAlignment="Top" Margin="5 0 0 0">
                                                    <DockPanel Height="22">
                                                        <Image Margin="0 2 4 0" Width="20" Height="20" RenderOptions.BitmapScalingMode="Fant"
                                                               Source="Images/search.png"/>
                                                        <TextBlock FontWeight="Bold" FontSize="12" VerticalAlignment="Bottom" Text="Banner"/>
                                                        <Control Margin="4 2 0 0" Style="{StaticResource BusyAnimationStyle}"
                                                                 Visibility="{Binding Path=IsBannerScanRunning, FallbackValue=Collapsed,
                                                                                        Converter={StaticResource BoolToVisisbility}}">
                                                            <Control.LayoutTransform>
                                                                <ScaleTransform ScaleX="0.55" ScaleY="0.55"/>
                                                            </Control.LayoutTransform>
                                                        </Control>
                                                    </DockPanel>
                                                </Button>
                                            </Grid>

                                            <TextBlock Grid.Row="1" Margin="32 8 0 0" FontWeight="Bold" FontSize="14" Text="Port" Visibility="{Binding
                                                Path=PortDescriptions.Count, Converter={StaticResource ZeroToVisibility}}"/>
                                            <TextBlock Grid.Row="1" Margin="69 8 0 0" FontWeight="Bold" FontSize="14" Text="Type" Visibility="{Binding
                                                Path=PortDescriptions.Count, Converter={StaticResource ZeroToVisibility}}"/>
                                            <TextBlock Grid.Row="1" Margin="106 8 0 0" FontWeight="Bold" FontSize="14" Text="Description" Visibility="{Binding
                                                Path=PortDescriptions.Count, Converter={StaticResource ZeroToVisibility}}"/>

                                            <ItemsControl Grid.Row="1" Margin="20 28 0 25" ItemsSource="{Binding Path=PortDescriptions}">
                                                <ItemsControl.ItemTemplate>
                                                    <DataTemplate>
                                                        <Grid>
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="50"/>
                                                                <ColumnDefinition Width="35"/>
                                                                <ColumnDefinition Width="600"/>
                                                            </Grid.ColumnDefinitions>

                                                            <TextBlock Grid.Column="0" Margin="0 0 10 0" HorizontalAlignment="Right" FontSize="14"
                                                                               Text="{Binding Path=Port}"/>
                                                            <TextBlock Grid.Column="1" HorizontalAlignment="Left" FontSize="14"
                                                                       Text="{Binding Path=Protocol}"/>
                                                            <TextBlock Grid.Column="2" Margin="2 0 0 0" TextWrapping="Wrap" FontSize="13" Text="{Binding Path=Description}"/>
                                                        </Grid>
                                                    </DataTemplate>
                                                </ItemsControl.ItemTemplate>
                                            </ItemsControl>

                                            <Border Grid.Row="1" Background="#94daef" Margin="717 0 0 0"
                                                    BorderThickness="1" BorderBrush="#94daef"/>

                                            <ItemsControl Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="2" Margin="0 5 0 10"
                                                          ItemsSource="{Binding Source={StaticResource DomainDisplays}}">
                                                <ItemsControl.ItemTemplate>
                                                    <DataTemplate>
                                                        <Grid Margin="0 5 0 0">
                                                            <Grid.Resources>
                                                                <CollectionViewSource Source="{Binding Path=Subdomains}" x:Key="Subdomains">
                                                                    <CollectionViewSource.SortDescriptions>
                                                                        <scm:SortDescription PropertyName="."/>
                                                                    </CollectionViewSource.SortDescriptions>
                                                                </CollectionViewSource>
                                                            </Grid.Resources>

                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="200"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                            </Grid.ColumnDefinitions>

                                                            <Grid.RowDefinitions>
                                                                <RowDefinition/>
                                                                <RowDefinition/>
                                                            </Grid.RowDefinitions>

                                                            <DockPanel Grid.Column="0">
                                                                <Border DockPanel.Dock="Left" Width="20" Background="#94daef"
                                                                        Margin="0 14 0 13" BorderThickness="1" BorderBrush="#94daef"/>
                                                                <TextBox DockPanel.Dock="Left" FontSize="15" HorizontalContentAlignment="Center" 
                                                                         VerticalContentAlignment="Center" Height="30"
                                                                         VerticalAlignment="Top" IsReadOnly="true" Grid.Column="0"
                                                                         Text="{Binding Path=Host, Mode=OneWay}">
                                                                    <TextBox.Style>
                                                                        <Style TargetType="{x:Type TextBox}">
                                                                            <Setter Property="Background" Value="#EEE"/>
                                                                        </Style>
                                                                    </TextBox.Style>
                                                                </TextBox>
                                                            </DockPanel>

                                                            <Button Grid.Column="1" HorizontalAlignment="Left"
                                                                    Command="{Binding Path=DataContext.ScanSubdomainsCommand,
                                                                                      RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Window}}"
                                                                    CommandParameter="{Binding Path=.}" Height="20"
                                                                    VerticalAlignment="Top" Margin="20 0 0 0">
                                                                <DockPanel Height="22">
                                                                    <Image Margin="0 2 4 0" Width="20" Height="20" RenderOptions.BitmapScalingMode="Fant"
                                                                           Source="Images/search.png"/>
                                                                    <TextBlock FontWeight="Bold" FontSize="12" VerticalAlignment="Bottom" Text="Subdomains"/>
                                                                    <Control Margin="4 2 0 0" Style="{StaticResource BusyAnimationStyle}"
                                                                             Visibility="{Binding Path=IsSubdomainScanRunning,
                                                                                        Converter={StaticResource BoolToVisisbility}}">
                                                                        <Control.LayoutTransform>
                                                                            <ScaleTransform ScaleX="0.55" ScaleY="0.55"/>
                                                                        </Control.LayoutTransform>
                                                                    </Control>
                                                                </DockPanel>
                                                            </Button>

                                                            <Border Grid.Row="1" Grid.Column="0" Background="#94daef"
                                                                    Margin="197 0 0 18" BorderThickness="1" BorderBrush="#94daef"/>

                                                            <ItemsControl Grid.Row="1" Grid.Column="1" Margin="0 5 0 5"
                                                                          ItemsSource="{Binding Source={StaticResource Subdomains}}">
                                                                <ItemsControl.ItemTemplate>
                                                                    <DataTemplate>
                                                                        <DockPanel Margin="0 5 0 0">
                                                                            <Border DockPanel.Dock="Left" Width="20"
                                                                                    Background="#94daef" Margin="0 14 0 13"
                                                                                    BorderThickness="1" BorderBrush="#94daef"/>
                                                                            <DockPanel DockPanel.Dock="Left" >
                                                                                <Button Padding="0" DockPanel.Dock="Right"
                                                                                        Command="{Binding Path=DataContext.CopyLinkCommand,
                                                                                    RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Window}}">
                                                                                    <Button.CommandParameter>
                                                                                        <MultiBinding Converter="{StaticResource HttpUrlConverter}">
                                                                                            <Binding Path="."/>
                                                                                            <Binding Path="DataContext.Host" RelativeSource="{RelativeSource
                                                                                            Mode=FindAncestor, AncestorType=Grid, AncestorLevel=1}"/>
                                                                                            <Binding Path="DataContext.PortDescriptions"
                                                                                                     RelativeSource="{RelativeSource Mode=FindAncestor,
                                                                                                                    AncestorType=Grid, AncestorLevel=2}"/>
                                                                                        </MultiBinding>
                                                                                    </Button.CommandParameter>
                                                                                    <Image Source="Images/copy-link.png" Width="16" Height="16"
                                                                                           RenderOptions.BitmapScalingMode="Fant"/>
                                                                                </Button>
                                                                                <TextBox Width="200" FontSize="15" HorizontalContentAlignment="Center" 
                                                                                         VerticalContentAlignment="Center" Height="30"
                                                                                         VerticalAlignment="Top" IsReadOnly="true" Grid.Column="0"
                                                                                         Text="{Binding Path=., Mode=OneWay}">
                                                                                    <TextBox.Style>
                                                                                        <Style TargetType="{x:Type TextBox}">
                                                                                            <Setter Property="Background" Value="#EEE"/>
                                                                                        </Style>
                                                                                    </TextBox.Style>
                                                                                </TextBox>
                                                                            </DockPanel>
                                                                            <Button DockPanel.Dock="Left" HorizontalAlignment="Right"
                                                                                    Command="{Binding Path=DataContext.AddWebScanCommand,
                                                                                      RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Window}}"
                                                                                    Height="20" VerticalAlignment="Top"
                                                                                    Margin="20 0 0 0">
                                                                                <DockPanel Height="22">
                                                                                    <Image Margin="0 2 5 0" Width="16" Height="16"
                                                                                           RenderOptions.BitmapScalingMode="Fant" Source="Images/add.png"/>
                                                                                    <TextBlock FontWeight="Bold" FontSize="12" VerticalAlignment="Bottom"
                                                                                               Text="Web"/>
                                                                                </DockPanel>
                                                                                <Button.CommandParameter>
                                                                                    <MultiBinding Converter="{StaticResource HttpUrlConverter}">
                                                                                        <Binding Path="."/>
                                                                                        <Binding Path="DataContext.Host" RelativeSource="{RelativeSource
                                                                                            Mode=FindAncestor, AncestorType=Grid, AncestorLevel=1}"/>
                                                                                        <Binding Path="DataContext.PortDescriptions"
                                                                                                 RelativeSource="{RelativeSource Mode=FindAncestor,
                                                                                                                    AncestorType=Grid, AncestorLevel=2}"/>
                                                                                    </MultiBinding>
                                                                                </Button.CommandParameter>
                                                                            </Button>
                                                                        </DockPanel>
                                                                    </DataTemplate>
                                                                </ItemsControl.ItemTemplate>
                                                            </ItemsControl>
                                                        </Grid>
                                                    </DataTemplate>
                                                </ItemsControl.ItemTemplate>
                                            </ItemsControl>
                                        </Grid>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>
                    </DockPanel>
                </DockPanel>
            </TabItem>
            <TabItem>
                <TabItem.Header>
                    <StackPanel Width="75">
                        <TextBlock HorizontalAlignment="Center" FontSize="14" FontWeight="SemiBold" Text="Whois"/>
                        <TextBlock HorizontalAlignment="Center" FontSize="12" Text="Networks"/>
                    </StackPanel>
                </TabItem.Header>
                <DockPanel Margin="15">
                    <ScrollViewer>
                        <ScrollViewer.Resources>
                            <CollectionViewSource Source="{Binding Path=SelectedTargetDisplay.WhoisDisplays}"
                                                  x:Key="WhoisDisplays">
                                <CollectionViewSource.SortDescriptions>
                                    <scm:SortDescription PropertyName="Header"/>
                                </CollectionViewSource.SortDescriptions>
                            </CollectionViewSource>
                        </ScrollViewer.Resources>

                        <ItemsControl ItemsSource="{Binding Source={StaticResource WhoisDisplays}}">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <WrapPanel/>
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Background="#666" BorderBrush="#ddd" BorderThickness="1" Margin="6">
                                        <Grid Height="400" Width="600">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="50px"/>
                                                <RowDefinition Height="*"/>
                                            </Grid.RowDefinitions>

                                            <DockPanel>
                                                <TextBlock DockPanel.Dock="Left" Margin="15 10 10 5" FontSize="24" FontWeight="Bold" Foreground="#fff"
                                                           Text="{Binding Path=Header}"/>
                                                <Button DockPanel.Dock="Left" HorizontalAlignment="Left" Padding="0" Height="20" Width="20"
                                                    Command="{Binding Path=DataContext.CopyStringCommand, RelativeSource={RelativeSource Mode=FindAncestor,
                                                    AncestorType=Window}}" CommandParameter="{Binding Path=Header}">
                                                    <Image Source="Images/copy-link.png" Width="16" Height="16"
                                                       RenderOptions.BitmapScalingMode="Fant"/>
                                                </Button>
                                            </DockPanel>

                                            <ScrollViewer Margin="15 5 15 15" Grid.Row="1">
                                                <TextBox FontFamily="Consolas" Background="#fff" TextWrapping="Wrap" Foreground="#222" Text="{Binding Path=Content, Mode=OneWay}"/>
                                            </ScrollViewer>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                </DockPanel>
            </TabItem>
            <TabItem>
                <TabItem.Header>
                    <StackPanel Width="70">
                        <TextBlock HorizontalAlignment="Center" FontSize="14" FontWeight="SemiBold" Text="Banner"/>
                        <TextBlock HorizontalAlignment="Center" FontSize="12" Text="Versions"/>
                    </StackPanel>
                </TabItem.Header>
                <DockPanel Margin="15">
                    <DockPanel DockPanel.Dock="Top">
                        <DockPanel.Resources>
                            <CollectionViewSource Source="{Binding Path=SelectedTargetDisplay.BasicScanItemDisplays, Converter={StaticResource BasicScanItemsWithBanner}}" x:Key="BannerScanItemDisplays">
                                <CollectionViewSource.SortDescriptions>
                                    <scm:SortDescription PropertyName="IPAddress"/>
                                </CollectionViewSource.SortDescriptions>
                            </CollectionViewSource>
                        </DockPanel.Resources>
                        <Label DockPanel.Dock="Left" FontWeight="SemiBold" Content="IP" Padding="8 8 8 0"/>
                        <ComboBox DockPanel.Dock="Left" Width="350" Margin="3" ItemsSource="{Binding Source={StaticResource BannerScanItemDisplays}}"
                                  SelectedItem="{Binding Path=SelectedTargetDisplay.SelectedBannerScanItemDisplay}" SelectedIndex="0">
                            <ComboBox.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock DockPanel.Dock="Left" Text="{Binding Path=IPAddress}"/>
                                </DataTemplate>
                            </ComboBox.ItemTemplate>
                        </ComboBox>
                        <Control Margin="4 2 0 0" Style="{StaticResource BusyAnimationStyle}"
                                 Visibility="{Binding Path=SelectedTargetDisplay.SelectedBannerScanItemDisplay.IsBannerScanRunning,
                            Converter={StaticResource BoolToVisisbility}, FallbackValue='Collapsed'}">
                            <Control.LayoutTransform>
                                <ScaleTransform ScaleX="0.55" ScaleY="0.55"/>
                            </Control.LayoutTransform>
                        </Control>
                        <Grid></Grid>
                    </DockPanel>

                    <ScrollViewer Margin="0 3 3 3">
                        <ScrollViewer.Resources>
                            <CollectionViewSource Source="{Binding Path=SelectedTargetDisplay.SelectedBannerScanItemDisplay.PortDescriptions}"
                                                  x:Key="BannerPortDescriptions">
                                <CollectionViewSource.SortDescriptions>
                                    <scm:SortDescription PropertyName="Port"/>
                                </CollectionViewSource.SortDescriptions>
                            </CollectionViewSource>
                        </ScrollViewer.Resources>

                        <ItemsControl ItemsSource="{Binding Source={StaticResource BannerPortDescriptions}}">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <WrapPanel/>
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Background="#666" BorderBrush="#ddd" BorderThickness="1" Margin="6">
                                        <Grid Height="400" Width="600">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="50px"/>
                                                <RowDefinition Height="*"/>
                                            </Grid.RowDefinitions>

                                            <DockPanel>
                                                <TextBlock DockPanel.Dock="Left" Margin="15 10 0 10" FontSize="24" FontWeight="Bold" Foreground="#fff" Text="Port "/>
                                                <TextBlock DockPanel.Dock="Left" Margin="0 10 5 5" FontSize="24" FontWeight="Bold" Foreground="#fff"
                                                           Text="{Binding Path=Port}"/>
                                                <TextBlock DockPanel.Dock="Left" Margin="0 10 0 5" FontSize="24" FontWeight="Bold" Foreground="#fff"
                                                           Text="("/>
                                                <TextBlock DockPanel.Dock="Left" Margin="0 10 0 5" FontSize="24" FontWeight="Bold" Foreground="#fff"
                                                           Text="{Binding Path=Protocol}"/>
                                                <TextBlock DockPanel.Dock="Left" Margin="0 10 10 5" FontSize="24" FontWeight="Bold" Foreground="#fff"
                                                           Text=")"/>
                                                <Button HorizontalAlignment="Left" Padding="0" Margin="0 5 0 0" Height="20" Width="20" DockPanel.Dock="Left"
                                                        Command="{Binding Path=DataContext.CopyStringCommand, RelativeSource={RelativeSource
                                                                    Mode=FindAncestor, AncestorType=Window}}">
                                                    <Button.CommandParameter>
                                                        <MultiBinding Converter="{StaticResource IpPort}">
                                                            <Binding Path="DataContext.SelectedTargetDisplay.SelectedBannerScanItemDisplay.IPAddress"
                                                                     RelativeSource="{RelativeSource Mode=FindAncestor, AncestorType=ScrollViewer}"/>
                                                            <Binding Path="Port"/>
                                                        </MultiBinding>
                                                    </Button.CommandParameter>
                                                    <Image Source="Images/copy-link.png" Width="16" Height="16"
                                                                                           RenderOptions.BitmapScalingMode="Fant"/>
                                                </Button>
                                            </DockPanel>

                                            <ScrollViewer Margin="15 5 15 15" Grid.Row="1">
                                                <TextBox FontFamily="Consolas" Background="#fff" TextWrapping="Wrap" Foreground="#222" Text="{Binding Path=Banner, Mode=OneWay}"/>
                                            </ScrollViewer>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                </DockPanel>
            </TabItem>
            <TabItem>
                <TabItem.Header>
                    <StackPanel Width="50">
                        <TextBlock HorizontalAlignment="Center" FontSize="14" FontWeight="SemiBold" Text="Web"/>
                    </StackPanel>
                </TabItem.Header>
                <DockPanel Margin="15">
                    <DockPanel DockPanel.Dock="Top">
                        <DockPanel.Resources>
                            <CollectionViewSource Source="{Binding Path=SelectedTargetDisplay.WebScanItemDisplays}" x:Key="WebScanItemDisplays">
                                <CollectionViewSource.SortDescriptions>
                                    <scm:SortDescription PropertyName="HttpUrl.FullUrl"/>
                                </CollectionViewSource.SortDescriptions>
                            </CollectionViewSource>
                        </DockPanel.Resources>
                        <Label DockPanel.Dock="Left" FontWeight="SemiBold" Content="URL" Padding="2 8 8 0"/>
                        <ComboBox DockPanel.Dock="Left" Width="350" Margin="3" ItemsSource="{Binding Source={StaticResource WebScanItemDisplays}}"
                                  SelectedItem="{Binding Path=SelectedTargetDisplay.SelectedWebScanItemDisplay}">
                            <ComboBox.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding Path=HttpUrl.FullUrl}"/>
                                </DataTemplate>
                            </ComboBox.ItemTemplate>
                        </ComboBox>
                        <Button Height="24" VerticalAlignment="Top" Command="{Binding Path=AddWebScanCommand}" Padding="12 2 8 3" Margin="4 3 3 3">
                            <DockPanel Height="22">
                                <Image Margin="0 2 5 0" Width="14" Height="14" RenderOptions.BitmapScalingMode="Fant"
                                       Source="Images/add.png"/>
                            </DockPanel>
                        </Button>
                        <Grid></Grid>
                    </DockPanel>

                    <TabControl DockPanel.Dock="Top" Margin="0 5 0 0">
                        <TabControl.Style>
                            <Style TargetType="{x:Type TabControl}">
                                <Setter Property="IsEnabled" Value="True"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding Path=SelectedTargetDisplay.WebScanItemDisplays.Count}" Value="0">
                                        <Setter Property="IsEnabled" Value="False"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TabControl.Style>
                        <TabItem>
                            <TabItem.Header>
                                <StackPanel Width="60">
                                    <TextBlock HorizontalAlignment="Center" FontSize="14" FontWeight="SemiBold" Text="Robots"/>
                                </StackPanel>
                            </TabItem.Header>
                            <DockPanel Margin="15">
                                <Button DockPanel.Dock="Top" HorizontalAlignment="Left" Command="{Binding Path=ScanRobotsCommand}">
                                    <DockPanel Height="22" Margin="0 0 3 0">
                                        <Image Margin="0 2 4 0" Width="20" Height="20" RenderOptions.BitmapScalingMode="Fant" Source="Images/search.png"/>
                                        <TextBlock FontWeight="Bold" FontSize="12" VerticalAlignment="Bottom" Text="Robots"/>
                                        <Control Margin="4 2 0 0" Style="{StaticResource BusyAnimationStyle}"
                                                 Visibility="{Binding Path=SelectedTargetDisplay.SelectedWebScanItemDisplay.IsRobotsScanRunning,
                                                                Converter={StaticResource BoolToVisisbility}, FallbackValue=Collapsed}">
                                            <Control.LayoutTransform>
                                                <ScaleTransform ScaleX="0.55" ScaleY="0.55"/>
                                            </Control.LayoutTransform>
                                        </Control>
                                    </DockPanel>
                                </Button>

                                <gui:EnhancedListView Margin="0 10 0 0" ItemsSource="{Binding Path=SelectedTargetDisplay.SelectedWebScanItemDisplay.RobotsResults}">
                                    <gui:EnhancedListView.View>
                                        <GridView>
                                            <GridViewColumn Header="Type" Width="100" DisplayMemberBinding="{Binding Path=Type}"
                                                            gui:EnhancedListView.TargetPropertyName="Type"
                                                            gui:EnhancedListView.IsFilterEnabled="True"
                                                            gui:EnhancedListView.IsSortingEnabled="True"/>
                                            <GridViewColumn Header="Path" Width="800"
                                                            gui:EnhancedListView.TargetPropertyName="HttpUrl.FullPath"
                                                            gui:EnhancedListView.IsFilterEnabled="True"
                                                            gui:EnhancedListView.IsSortingEnabled="True">
                                                <GridViewColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <DockPanel>
                                                            <Button Background="Transparent" DockPanel.Dock="Left"  Padding="0"
                                                                    Width="22" Height="22" Command="{Binding Path=DataContext.CopyLinkCommand,
                                                                            RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Window}}"
                                                                    CommandParameter="{Binding Path=HttpUrl}">
                                                                <Button.Style>
                                                                    <Style TargetType="{x:Type Button}">
                                                                        <Setter Property="BorderThickness" Value="0"/>
                                                                        <Setter Property="Width" Value="8"/>
                                                                        <Setter Property="Height" Value="8"/>
                                                                    </Style>
                                                                </Button.Style>
                                                                <Image Source="Images/copy-link.png" Width="12" Height="12"
                                                                                           RenderOptions.BitmapScalingMode="Fant"/>
                                                            </Button>
                                                            <TextBlock Margin="5 0 0 0" Text="{Binding Path=HttpUrl.FullPath}"/>
                                                        </DockPanel>
                                                    </DataTemplate>
                                                </GridViewColumn.CellTemplate>
                                            </GridViewColumn>
                                            <GridViewColumn Header="Base URL" Width="300" DisplayMemberBinding="{Binding Path=HttpUrl.BaseUrl}"
                                                            gui:EnhancedListView.TargetPropertyName="HttpUrl.BaseUrl"
                                                            gui:EnhancedListView.IsFilterEnabled="True"
                                                            gui:EnhancedListView.IsSortingEnabled="True"/>
                                        </GridView>
                                    </gui:EnhancedListView.View>
                                </gui:EnhancedListView>
                            </DockPanel>
                        </TabItem>
                        <TabItem>
                            <TabItem.Header>
                                <StackPanel Width="85">
                                    <TextBlock HorizontalAlignment="Center" FontSize="14" FontWeight="SemiBold" Text="Path finder"/>
                                </StackPanel>
                            </TabItem.Header>
                            <DockPanel Margin="15">
                                <Button DockPanel.Dock="Top" HorizontalAlignment="Left" Command="{Binding Path=ScanPathsCommand}">
                                    <DockPanel Height="22" Margin="0 0 3 0">
                                        <Image Margin="0 2 4 0" Width="20" Height="20" RenderOptions.BitmapScalingMode="Fant" Source="Images/search.png"/>
                                        <TextBlock FontWeight="Bold" FontSize="12" VerticalAlignment="Bottom" Text="Paths"/>
                                        <Control Margin="4 2 0 0" Style="{StaticResource BusyAnimationStyle}"
                                                 Visibility="{Binding Path=SelectedTargetDisplay.SelectedWebScanItemDisplay.IsPathScanRunning,
                                                                Converter={StaticResource BoolToVisisbility}, FallbackValue=Collapsed}">
                                            <Control.LayoutTransform>
                                                <ScaleTransform ScaleX="0.55" ScaleY="0.55"/>
                                            </Control.LayoutTransform>
                                        </Control>
                                    </DockPanel>
                                </Button>

                                <gui:EnhancedListView Margin="0 10 0 0" ItemsSource="{Binding Path=SelectedTargetDisplay.SelectedWebScanItemDisplay.PathResults}">
                                    <gui:EnhancedListView.View>
                                        <GridView>
                                            <GridViewColumn Header="Path" Width="800"
                                                            gui:EnhancedListView.TargetPropertyName="FullUrl"
                                                            gui:EnhancedListView.IsFilterEnabled="True"
                                                            gui:EnhancedListView.IsSortingEnabled="True">
                                                <GridViewColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <DockPanel>
                                                            <Button Background="Transparent" DockPanel.Dock="Left"  Padding="0"
                                                                    Width="22" Height="22" Command="{Binding Path=DataContext.CopyStringCommand,
                                                                            RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Window}}"
                                                                    CommandParameter="{Binding Path=FullUrl}">
                                                                <Button.Style>
                                                                    <Style TargetType="{x:Type Button}">
                                                                        <Setter Property="BorderThickness" Value="0"/>
                                                                        <Setter Property="Width" Value="8"/>
                                                                        <Setter Property="Height" Value="8"/>
                                                                    </Style>
                                                                </Button.Style>
                                                                <Image Source="Images/copy-link.png" Width="12" Height="12"
                                                                                           RenderOptions.BitmapScalingMode="Fant"/>
                                                            </Button>
                                                            <TextBlock Margin="5 0 0 0" Text="{Binding Path=FullUrl}"/>
                                                        </DockPanel>
                                                    </DataTemplate>
                                                </GridViewColumn.CellTemplate>
                                            </GridViewColumn>
                                        </GridView>
                                    </gui:EnhancedListView.View>
                                </gui:EnhancedListView>
                            </DockPanel>
                        </TabItem>
                    </TabControl>
                </DockPanel>
            </TabItem>
        </TabControl>
    </DockPanel>
</Window>
